{"remainingRequest":"/Volumes/Document/Fireapps/DSSellerFE/ds-seller-frontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/Volumes/Document/Fireapps/DSSellerFE/ds-seller-frontend/src/modules/seller/_components/subscription.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Volumes/Document/Fireapps/DSSellerFE/ds-seller-frontend/src/modules/seller/_components/subscription.vue","mtime":1554347265853},{"path":"/Volumes/Document/Fireapps/DSSellerFE/ds-seller-frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Volumes/Document/Fireapps/DSSellerFE/ds-seller-frontend/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Volumes/Document/Fireapps/DSSellerFE/ds-seller-frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Volumes/Document/Fireapps/DSSellerFE/ds-seller-frontend/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport {mapActions} from 'vuex'\nimport moment from 'moment'\nimport carddialog from './card-dialog'\nimport pagination from '@/components/pagination'\n\nexport default {\n    name: \"subscription\",\n    data() {\n        return {\n            data: {\n                subscription_payment_history: []\n            },\n            pagination: {\n                total_page: 0\n            },\n            cardInfo: {},\n            isCardDialogShow: false\n        }\n    },\n    components: {\n        carddialog, pagination\n    },\n    methods: {\n        ...mapActions({\n            getPaymentHistory: '$_Seller/GET_PAYMENT_HISTORY',\n            changeCard: '$_Seller/CHANGE_PAYMENT_ACCOUNT',\n            cancelSubscription: '$_Seller/CANCEL_SUBSCRIPTION'\n        }),\n        moment(date) {\n            return moment(date)\n        },\n        initPaymentHistory: function (page) {\n            this.getPaymentHistory(page).then(res => {\n                console.log(res.data);\n                this.data = res.data.data\n                this.pagination = res.data.pagination\n                this.cardInfo = res.data.info_card\n                console.log(this.pagination);\n            })\n        },\n        cancel_subscription() {\n          this.cancelSubscription().then(res => {\n              if (res.data.status) {\n                  $notify({\n                      content: \"Cancel subscription success\",\n                      type: \"success\",\n\n                  })\n                  this.initPaymentHistory();\n              }\n          })\n        },\n        changePaymentAcount(cardInfo) {\n            // this.isCardDialogShow = true\n            let democart = {\n                \"card_no\": cardInfo.card_no.replace(/\\W/gi, ''),\n                \"ccExpiryMonth\": cardInfo.expire_date.split('/')[0],\n                \"ccExpiryYear\": cardInfo.expire_date.split('/')[1],\n                \"cvvNumber\": cardInfo.secure_code,\n            }\n            this.isCardDialogShow = false\n            this.changeCard(democart).then(res => {\n                if (res.data.status) {\n                    $notify({\n                        content: \"Change card success\",\n                        type: \"success\"\n                    })\n                    this.initPaymentHistory()\n                } else {\n                    $notify({\n                        content: \"Change card fail\",\n                        type: \"danger\"\n                    })\n                    this.isCardDialogShow = true\n                }\n\n            })\n\n        },\n    },\n    created: function () {\n        let page = this.$route.query['page'];\n        this.initPaymentHistory(page)\n    }\n}\n",{"version":3,"sources":["subscription.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmGA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA","file":"subscription.vue","sourceRoot":"src/modules/seller/_components","sourcesContent":["<template>\n    <div class=\"subscription-container\">\n        <div class=\"subscription-table-container\">\n            <table class=\"subscription-table table\">\n                <thead>\n                <tr>\n                    <th>Membership</th>\n                    <th>Subscription</th>\n                    <th>Active</th>\n                    <th>Created</th>\n                    <th></th>\n                </tr>\n                </thead>\n                <tbody>\n                <tr>\n                    <td>\n                        <p>Monthly subscription</p>\n                        <p class=\"text-warning\">{{data.stripe_subscription_id}}</p>\n                    </td>\n                    <td>\n                        <p class=\"text-warning\">1 week for free then {{data.price}} / month</p>\n                        <p class=\"text-warning\" v-if=\"data.invoice_upcoming\">Next Billing:\n                            {{moment(data.invoice_upcoming).format(\"LL\")}}</p>\n                    </td>\n                    <td class=\"text-danger\">\n                        {{data.subscription_active?\"Yes\":\"No\"}}\n                    </td>\n                    <td>{{moment(data.subscription_date).format(\"LL\")}}</td>\n                    <td><span class=\"action-link text-warning\" v-if=\"data.plan_name!='free'\" @click=\"cancel_subscription\">Cancel</span></td>\n                </tr>\n                </tbody>\n            </table>\n        </div>\n        <div class=\"row\">\n            <div v-if=\"data.subscription_payment_history.length\" class=\"title-container col col-6\">\n                <div class=\"product-filter-title\">\n                    <span>Payment History</span>\n                </div>\n                <div class=\"subscription-table-container\">\n                    <table class=\"hisotry-table table\">\n                        <thead>\n                        <tr>\n                            <th>Payment</th>\n                            <th>Date</th>\n                            <th>Amount</th>\n                        </tr>\n                        </thead>\n                        <tbody>\n                        <tr v-for=\"item in data.subscription_payment_history\">\n                            <td class=\"text-warning\">{{item.plan_name.toUpperCase()}}</td>\n                            <td>{{moment(item.created_at).format(\"LL\")}}</td>\n                            <td class=\"text-warning\">${{item.price}}</td>\n                        </tr>\n                        </tbody>\n                    </table>\n                    <nav class=\"mt-4\">\n                        <pagination :routerLink=\"false\" :disabled=\"false\" :total=\"pagination.total_page\"\n                                    :change=\"initPaymentHistory\" v-model=\"pagination.current_page\"></pagination>\n                    </nav>\n                </div>\n            </div>\n            <div v-if=\"cardInfo\" class=\"title-container col col-6\">\n                <div class=\"product-filter-title\">\n                    <span>Payment Setting</span>\n                </div>\n                <div class=\"subscription-table-container\">\n                    <table class=\"hisotry-table table\">\n                        <thead>\n                        <tr>\n                            <th>Card Number</th>\n                            <th>Expiry Date</th>\n                            <th></th>\n                        </tr>\n                        </thead>\n                        <tbody>\n                        <tr>\n                            <td>\n                                <div class=\"card-type-img\">\n                                    <img v-if=\"cardInfo.type == 'Visa'\" src=\"../../../assets/images/icons/visa.png\">\n                                    <img v-if=\"cardInfo.type == 'Master'\"\n                                         src=\"../../../assets/images/icons/master.png\" alt=\"\">\n                                </div>\n                                **** **** **** {{cardInfo.number}}\n                            </td>\n                            <td>{{cardInfo.expire_date}}</td>\n                            <td><span class=\"action-link text-warning\" @click=\"isCardDialogShow = true\">Change</span>\n                            </td>\n                        </tr>\n                        </tbody>\n                    </table>\n                </div>\n            </div>\n        </div>\n        <carddialog :isShow=\"isCardDialogShow\" @modalHide=\"isCardDialogShow=false\"\n                    @dialogConfirm=\"changePaymentAcount\"></carddialog>\n    </div>\n</template>\n\n<script>\n    import {mapActions} from 'vuex'\n    import moment from 'moment'\n    import carddialog from './card-dialog'\n    import pagination from '@/components/pagination'\n\n    export default {\n        name: \"subscription\",\n        data() {\n            return {\n                data: {\n                    subscription_payment_history: []\n                },\n                pagination: {\n                    total_page: 0\n                },\n                cardInfo: {},\n                isCardDialogShow: false\n            }\n        },\n        components: {\n            carddialog, pagination\n        },\n        methods: {\n            ...mapActions({\n                getPaymentHistory: '$_Seller/GET_PAYMENT_HISTORY',\n                changeCard: '$_Seller/CHANGE_PAYMENT_ACCOUNT',\n                cancelSubscription: '$_Seller/CANCEL_SUBSCRIPTION'\n            }),\n            moment(date) {\n                return moment(date)\n            },\n            initPaymentHistory: function (page) {\n                this.getPaymentHistory(page).then(res => {\n                    console.log(res.data);\n                    this.data = res.data.data\n                    this.pagination = res.data.pagination\n                    this.cardInfo = res.data.info_card\n                    console.log(this.pagination);\n                })\n            },\n            cancel_subscription() {\n              this.cancelSubscription().then(res => {\n                  if (res.data.status) {\n                      $notify({\n                          content: \"Cancel subscription success\",\n                          type: \"success\",\n\n                      })\n                      this.initPaymentHistory();\n                  }\n              })\n            },\n            changePaymentAcount(cardInfo) {\n                // this.isCardDialogShow = true\n                let democart = {\n                    \"card_no\": cardInfo.card_no.replace(/\\W/gi, ''),\n                    \"ccExpiryMonth\": cardInfo.expire_date.split('/')[0],\n                    \"ccExpiryYear\": cardInfo.expire_date.split('/')[1],\n                    \"cvvNumber\": cardInfo.secure_code,\n                }\n                this.isCardDialogShow = false\n                this.changeCard(democart).then(res => {\n                    if (res.data.status) {\n                        $notify({\n                            content: \"Change card success\",\n                            type: \"success\"\n                        })\n                        this.initPaymentHistory()\n                    } else {\n                        $notify({\n                            content: \"Change card fail\",\n                            type: \"danger\"\n                        })\n                        this.isCardDialogShow = true\n                    }\n\n                })\n\n            },\n        },\n        created: function () {\n            let page = this.$route.query['page'];\n            this.initPaymentHistory(page)\n        }\n    }\n</script>\n\n<style lang=\"scss\" scoped>\n    .subscription-container {\n        .product-filter-title {\n            margin-bottom: 35px;\n        }\n        .subscription-table-container {\n            .hisotry-table {\n                /*width: auto;*/\n                /*min-width: 50%;*/\n            }\n            .action-link {\n                &:hover {\n                    cursor: pointer;\n                }\n            }\n            .card-type-img {\n                display: inline-block;\n                margin-right: 10px;\n                img {\n                    width: 30px;\n                }\n            }\n        }\n    }\n</style>\n"]}]}