{"remainingRequest":"/Volumes/Document/Pau's test/pau's test FE/node_modules/babel-loader/lib/index.js!/Volumes/Document/Pau's test/pau's test FE/src/router/index.js","dependencies":[{"path":"/Volumes/Document/Pau's test/pau's test FE/src/router/index.js","mtime":1556255163856},{"path":"/Volumes/Document/Pau's test/pau's test FE/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Volumes/Document/Pau's test/pau's test FE/node_modules/babel-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"/Volumes/Document/Pau's test/pau's test FE/node_modules/@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport Vue from 'vue';\nimport store from '@/store';\nimport Router from 'vue-router';\nimport Error404 from '@/components/error-404';\nVue.use(Router);\nVue.component('router-link', Vue.options.components.RouterLink);\nVue.component('router-view', Vue.options.components.RouterView);\nvar router = new Router({\n  routes: [{\n    path: '*',\n    name: 'Error404',\n    component: Error404,\n    meta: {\n      title: '404'\n    }\n  }],\n  mode: 'history'\n});\nrouter.beforeEach(\n/*#__PURE__*/\nfunction () {\n  var _ref = _asyncToGenerator(\n  /*#__PURE__*/\n  regeneratorRuntime.mark(function _callee(to, from, next) {\n    var isLoggedIn, user, info, data;\n    return regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            isLoggedIn = store.getters['$_Account/isLoggedIn'];\n            store.commit('setRouter', to);\n            store.commit('setPreviousRouter', from);\n            console.log(to);\n\n            if (!(to.matched.some(function (record) {\n              return record.meta.requiresAuth;\n            }) && to.meta.requiresAuth != false)) {\n              _context.next = 31;\n              break;\n            }\n\n            if (!isLoggedIn) {\n              _context.next = 27;\n              break;\n            }\n\n            user = store.getters['$_Account/getUser'];\n\n            if (!(user == null)) {\n              _context.next = 25;\n              break;\n            }\n\n            _context.prev = 8;\n            _context.next = 11;\n            return store.dispatch('$_Account/GET_USER_INFO', {});\n\n          case 11:\n            info = _context.sent;\n            data = info.data;\n\n            if (!data) {\n              _context.next = 17;\n              break;\n            }\n\n            user = data; // check some condition here\n\n            _context.next = 19;\n            break;\n\n          case 17:\n            next({\n              name: 'Login'\n            });\n            return _context.abrupt(\"return\");\n\n          case 19:\n            _context.next = 25;\n            break;\n\n          case 21:\n            _context.prev = 21;\n            _context.t0 = _context[\"catch\"](8);\n            next(false);\n            return _context.abrupt(\"return\");\n\n          case 25:\n            _context.next = 29;\n            break;\n\n          case 27:\n            next({\n              name: 'Login'\n            });\n            return _context.abrupt(\"return\");\n\n          case 29:\n            _context.next = 44;\n            break;\n\n          case 31:\n            if (!isLoggedIn) {\n              _context.next = 44;\n              break;\n            }\n\n            if (!(to.meta.failback == true)) {\n              _context.next = 35;\n              break;\n            }\n\n            next('/');\n            return _context.abrupt(\"return\");\n\n          case 35:\n            user = store.getters['$_Account/getUser'];\n\n            if (!(user == null)) {\n              _context.next = 44;\n              break;\n            }\n\n            _context.prev = 37;\n            _context.next = 40;\n            return store.dispatch('$_Account/GET_USER_INFO', {});\n\n          case 40:\n            _context.next = 44;\n            break;\n\n          case 42:\n            _context.prev = 42;\n            _context.t1 = _context[\"catch\"](37);\n\n          case 44:\n            next();\n\n          case 45:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee, null, [[8, 21], [37, 42]]);\n  }));\n\n  return function (_x, _x2, _x3) {\n    return _ref.apply(this, arguments);\n  };\n}());\nexport default router;",{"version":3,"sources":["/Volumes/Document/Pau's test/pau's test FE/src/router/index.js"],"names":["Vue","store","Router","Error404","use","component","options","components","RouterLink","RouterView","router","routes","path","name","meta","title","mode","beforeEach","to","from","next","isLoggedIn","getters","commit","console","log","matched","some","record","requiresAuth","user","dispatch","info","data","failback"],"mappings":"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","sourcesContent":["import Vue from 'vue'\nimport store from '@/store'\nimport Router from 'vue-router'\nimport Error404 from '@/components/error-404'\n\nVue.use(Router)\nVue.component('router-link', Vue.options.components.RouterLink);\nVue.component('router-view', Vue.options.components.RouterView);\nconst router = new Router({\n    routes: [\n        {\n            path: '*',\n            name: 'Error404',\n            component: Error404,\n            meta: {\n                title: '404'\n            }\n        },\n    ],\n    mode: 'history',\n})\n\nrouter.beforeEach(async function (to, from, next) {\n    var isLoggedIn = store.getters['$_Account/isLoggedIn']\n    store.commit('setRouter', to)\n    store.commit('setPreviousRouter', from)\n    console.log(to)\n    if (to.matched.some(record => record.meta.requiresAuth) && to.meta.requiresAuth != false) {\n        if (isLoggedIn) {\n            var user = store.getters['$_Account/getUser']\n            if (user == null) {\n                try {\n                    var info = await store.dispatch('$_Account/GET_USER_INFO', {})\n                    let data = info.data\n                    if (data) {\n                        user = data\n                        // check some condition here\n                    } else {\n                        next({name: 'Login'})\n                        return;\n                    }\n                } catch (error) {\n                    next(false)\n                    return;\n                }\n            }\n        } else {\n            next({name: 'Login'})\n            return\n        }\n    } else {\n        if (isLoggedIn) {\n            if (to.meta.failback == true) {\n                next('/')\n                return\n            }\n            var user = store.getters['$_Account/getUser']\n            if (user == null) {\n                try {\n                    await store.dispatch('$_Account/GET_USER_INFO', {})\n                } catch (error) {\n\n                }\n            }\n        }\n    }\n    next()\n})\nexport default router\n"]}]}